<html>
    <head>
        <title>WebGL Solar System</title> <style>canvas { width: 100%; height: 100% } html,body { margin: 0; padding: 0; }</style>
    </head>
<body>
    <script src="three.min.js"></script>
    <script>
        (function() {
            var scene
            ,   renderer
            ,   camera
            ,   container
            ,   W, H
            ,   sun
            ,   earth
            ,   moon
            ,   stars
            ,   sunMaterial
            ,   clock
            ,   uniforms;

            init();
            animate();

            function createStars(amount, color, opacity) {
                var geometry = new THREE.Geometry();
                var material = new THREE.ParticleBasicMaterial({ color: color, opacity: opacity, size: 1, sizeAttenuation: true });

                for (var i = 0; i < amount; i++) {
                    var vertex = new THREE.Vector3();

                    vertex.x = Math.random() * 2 - 1;
                    vertex.y = Math.random() * 2 - 1;
                    vertex.z = Math.random() * 2 - 1;

                    vertex.multiplyScalar(6000);
                    geometry.vertices.push(vertex);
                }

                return new THREE.ParticleSystem(geometry, material);
            }

            function createPlanet(o) {
                var planetGeometry = new THREE.SphereGeometry(o.size, o.segments, o.rings);
                var texture = THREE.ImageUtils.loadTexture(o.texture);
                texture.anisotropy = 8;
                var planetMaterial = new THREE.MeshPhongMaterial({ map: texture, emissive: 0xffffff });;
                return new THREE.Mesh(planetGeometry, planetMaterial);
            };

            function init() {

                // Dom
                container = document.createElement('div');
                document.body.appendChild(container);

                // Camera
                W = window.innerWidth;
                H = window.innerHeight;
                camera = new THREE.PerspectiveCamera(30, W/H, 1, 100000);
                camera.position.z = 4000;

                // Scene
                scene = new THREE.Scene();

                // Renderer
                renderer = new THREE.WebGLRenderer({
                    antialias: true,
                    clearColor: 0x000000
                });
                renderer.setSize(W, H);
                renderer.autoClear = false;
                container.appendChild(renderer.domElement);
                
                // Creating planets
                sun = createPlanet({
                    size: 700,
                    segments: 100,
                    rings: 100,
                    texture: 'textures/sun.png'
                });

                earth = createPlanet({
                    size: 80,
                    segments: 60,
                    rings: 60,
                    texture: 'textures/earth.jpg'
                });
                earth.position.x = 1000;

                moon = createPlanet({
                    size: 30,
                    segments: 30,
                    rings: 30,
                    texture: 'textures/moon.jpg'
                });


                scene.add(sun);
                scene.add(earth);
                scene.add(moon);

                // Stars
                stars = createStars(100000, 0x333333, 1);
                stars.scale.set(25, 25, 25);
                scene.add(stars);

                start2 = createStars(100000, 0xffffff, 0.6);
                start2.scale.set(27, 27, 27);
                scene.add(start2);

                stars3 = createStars(100000, 0xffffff, 1);
                stars3.scale.set(20, 20, 20);
                scene.add(stars3);

                // Light
                var ambientLight = new THREE.AmbientLight( 0x333333 );
                scene.add(ambientLight);
            };


            // variables for animating
            var t = 0;

            function animate() {
                requestAnimationFrame(animate);

                sun.rotation.y += 0.01;
                earth.rotation.y -= 0.01;
                moon.rotation.y += 0.02;

                camera.lookAt(earth.position);
                camera.position.x = Math.sin(t * 0.05) * 2500; 
                camera.position.y = Math.cos(t * 0.05) * 2500;
                camera.position.z = earth.position.z * Math.sin(t * 0.05) * 3;

                t += Math.PI / 180 * 2;
                earth.position.x = Math.sin(t * 0.2) * 2500;
                earth.position.z = Math.cos(t * 0.2) * 2500;


                moon.position.x = earth.position.x + Math.sin(t * 0.5) * 250;
                moon.position.z = earth.position.z + Math.cos(t * 0.5) * 250;

                renderer.render(scene, camera);
            };

        }());
    </script>
</body>
</html>